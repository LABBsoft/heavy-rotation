<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Heavy Rotation | 2025</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <style>
        :root {
            --bg-color: #FAFAFA;
            --text-main: #222;
            --text-muted: #666;
            --card-shadow: 0 8px 24px rgba(0,0,0,0.04);
            --radius: 12px;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            margin: 0;
            padding: 60px 20px;
            line-height: 1.5;
        }

        .container { max-width: 800px; margin: 0 auto; }

        /* HEADER BRANDING */
        header { text-align: center; margin-bottom: 80px; }
        
        h1 { 
            font-size: 3.5rem; 
            margin: 0; 
            letter-spacing: -2px; 
            font-weight: 800; 
            display: inline-flex;
            align-items: center;
            gap: 15px;
        }

        /* The "Rotation" Icon */
        .record-icon {
            width: 40px; 
            height: 40px; 
            border: 4px solid #333; 
            border-radius: 50%; 
            position: relative;
            display: inline-block;
        }
        .record-icon::after {
            content: '';
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            width: 10px; height: 10px;
            background: #333;
            border-radius: 50%;
        }

        .subtitle {
            margin-top: 10px;
            font-size: 1.1rem;
            color: var(--text-muted);
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* FRIEND CARDS */
        .friend-section {
            background: white;
            border-radius: var(--radius);
            margin-bottom: 50px;
            box-shadow: var(--card-shadow);
            overflow: hidden;
            border: 1px solid rgba(0,0,0,0.03);
        }

        .friend-header {
            padding: 25px 30px;
            font-size: 1.4rem;
            font-weight: 800;
            letter-spacing: -0.5px;
            color: #222;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        /* DATA GRID */
        .item-row {
            display: grid;
            grid-template-columns: 110px 2fr 3fr; /* Badge | Title | Note */
            padding: 18px 30px;
            border-bottom: 1px solid #f4f4f4;
            align-items: baseline;
            gap: 20px;
            transition: background 0.1s;
        }
        .item-row:last-child { border-bottom: none; }
        .item-row:hover { background: #fafafa; }

        /* PILLS & BADGES */
        .pill {
            display: inline-block;
            padding: 6px 10px;
            border-radius: 6px;
            font-size: 0.7rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            text-align: center;
            width: fit-content;
        }

        .title { font-weight: 600; font-size: 1.05rem; color: #111; }
        
        .note {
            font-size: 0.95rem;
            color: #777;
            font-style: italic;
            line-height: 1.4;
        }

        /* MOBILE OPTIMIZATION */
        @media (max-width: 600px) {
            h1 { font-size: 2.5rem; }
            .item-row { 
                grid-template-columns: 1fr; 
                gap: 8px;
                padding: 15px 20px;
            }
            .pill { font-size: 0.65rem; padding: 4px 8px; margin-bottom: 4px; }
            .note { font-size: 0.9rem; }
        }
        
        /* LOADING STATE */
        #loading { text-align: center; color: #999; margin-top: 50px; }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>
            <span class="record-icon"></span>
            HEAVY ROTATION
        </h1>
        <div class="subtitle">The 2025 Collective Yearbook</div>
    </header>

    <div id="loading">Loading the tracks...</div>
    <div id="main-feed"></div>
</div>

<script>
    // --- CONFIGURATION ---
    const csvFile = 'favorites.csv'; 

    const colorMap = {
        "Alyssa Shaver": "#E1EAD1", // Sage
        "Khamil": "#F4E1E1",        // Rose
        "Callum": "#E1E7F0",        // Steel
        "Reid": "#F9F1D0",          // Gold
        "Alex": "#E8E1F4",          // Lavender
        "Sisley": "#FCEAD5",        // Peach
        "Patrick Chin": "#DDF2EB",  // Mint
        "Gabby Bzorek": "#F2D8C9",  // Terracotta
        "Angela Tollis": "#D6EAF8", // Sky
        "Luciano Abbott": "#E5E7E9",// Slate
        "Avery Cole": "#F5E8C7",    // Dusty Gold
        "Ryan Kasor": "#D9E3D0"     // Zen Green
    };

    // --- LOGIC ---
    Papa.parse(csvFile, {
        download: true,
        header: false,
        skipEmptyLines: true,
        complete: function(results) {
            document.getElementById('loading').style.display = 'none';
            processData(results.data);
        }
    });

    function processData(rows) {
        const groupedData = {};

        rows.forEach(row => {
            // CSV COLUMNS: [0] Name, [1] Category, [2] Title, [3] Note
            const name = row[0];
            const category = row[1];
            const title = row[2];
            const note = row[3] || "";

            if (!name || name === "Name") return;

            if (!groupedData[name]) groupedData[name] = [];
            groupedData[name].push({ category, title, note });
        });

        renderPage(groupedData);
    }

    function renderPage(data) {
        const container = document.getElementById('main-feed');
        
        Object.keys(data).forEach(name => {
            const items = data[name];
            const headerColor = colorMap[name] || "#eee";

            const itemsHtml = items.map(item => `
                <div class="item-row">
                    <div>${getPill(item.category)}</div>
                    <div class="title">${item.title}</div>
                    <div class="note">${item.note}</div>
                </div>
            `).join('');

            const section = document.createElement('div');
            section.className = 'friend-section';
            section.innerHTML = `
                <div class="friend-header" style="background-color: ${headerColor};">
                    ${name}
                </div>
                <div>${itemsHtml}</div>
            `;
            container.appendChild(section);
        });
    }

    function getPill(cat) {
        // Simple styling based on category text
        let bg = "#eee", text = "#555";
        
        if (cat.includes("Movie")) { bg = "#E3F2FD"; text = "#1565C0"; }
        else if (cat.includes("TV")) { bg = "#E8F5E9"; text = "#2E7D32"; }
        else if (cat.includes("Book")) { bg = "#FFF3E0"; text = "#EF6C00"; }
        else if (cat.includes("Song") || cat.includes("Album")) { bg = "#F3E5F5"; text = "#7B1FA2"; }
        else if (cat.includes("Game")) { bg = "#ECEFF1"; text = "#455A64"; }

        return `<span class="pill" style="background:${bg}; color:${text};">${cat}</span>`;
    }
</script>

</body>
</html>